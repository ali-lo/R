//STEP 1 - Create new database 
CREATE OR REPLACE DATABASE IMT577_DW_ALI_LO_STAGE;

//STEP 2 - Create IT Session DW
CREATE OR REPLACE WAREHOUSE "IMT577_DW_ALI_LO_STAGE" WITH WAREHOUSE_SIZE = 'XSMALL' AUTO_SUSPEND = 600 AUTO_RESUME = TRUE COMMENT = '';

//STEP 3 - Use Interface to Create Stage
CREATE OR REPLACE STAGE "IMT577_DW_ALI_LO_STAGE"."PUBLIC"."STAGE_PROJECT";

//STEP 4 - Create File Format
CREATE OR REPLACE FILE FORMAT CSV_SKIP_HEADER
type = 'CSV'
field_delimiter = ','
FIELD_OPTIONALLY_ENCLOSED_BY = '"'
skip_header = 1;

CREATE OR REPLACE FILE FORMAT CSV_SKIP_HEADER_DATE
type = 'CSV'
field_delimiter = ','
FIELD_OPTIONALLY_ENCLOSED_BY = '"'
skip_header = 1
date_format = 'MM/DD/YY';

//STEP 5 - Create Tables
-- #1 Channel Table
CREATE OR REPLACE TABLE STAGE_CHANNEL(
    CHANNELID NUMBER(38,0),
    CHANELCATEGORYID NUMBER(38,0),
    CHANNEL VARCHAR(255),
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255)
);

-- #2 ChannelCategory Table
CREATE OR REPLACE TABLE STAGE_CHANNELCATEGORY(
    CHANNELCATEGORYID NUMBER(38,0),
    CHANNELCATEGORY VARCHAR(255),
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255)
);

-- #3 Customer Table
CREATE OR REPLACE TABLE STAGE_CUSTOMER(
    CUSTOMERID VARCHAR(255),
    SUBSEGMENTID NUMBER(38,0),
    FIRSTNAME VARCHAR(255),
    LASTNAME VARCHAR(255),
    GENDER VARCHAR(255),
    EMAILADDRESS VARCHAR(255),
    ADDRESS VARCHAR(255),
    CITY VARCHAR(255),
    STATEPROVINCE VARCHAR(255),
    COUNTRY VARCHAR(255),
    POSTALCODE VARCHAR(255),
    PHONENUMBER VARCHAR(255),
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255)
);

-- #4 Product Table
CREATE OR REPLACE TABLE STAGE_PRODUCT(
    PRODUCTID NUMBER(38,0),
    PRODUCTTYPEID NUMBER(38,0),
    PRODUCT VARCHAR(255),
    COLOR VARCHAR(255),
    STYLE VARCHAR(255),
    UNITOFMEASUREID NUMBER(38,0),
    WEIGHT FLOAT,
    PRICE FLOAT,
    COST FLOAT,
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255),
    WHOLESALEPRICE FLOAT
);

-- #5 ProductCategory Table
CREATE OR REPLACE TABLE STAGE_PRODUCTCATEGORY(
    PRODUCTCATEGORYID NUMBER(38,0),
    PRODUCTCATEGORY VARCHAR(255),
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255)
);

-- #6 ProductType Table
CREATE OR REPLACE TABLE STAGE_PRODUCTTYPE(
    PRODUCTTYPEID NUMBER(38,0),
    PRODUCTCATEGORYID NUMBER(38,0),
    PRODUCTTYPE VARCHAR(255),
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255)
);

-- #7 Reseller Table
CREATE OR REPLACE TABLE STAGE_RESELLER(
    RESELLERID VARCHAR(255),
    CONTACT VARCHAR(255),
    EMAILADDRESS VARCHAR(255),
    ADDRESS VARCHAR(255),
    CITY VARCHAR(255),
    STATEPROVINCE VARCHAR(255),
    COUNTRY VARCHAR(255),
    POSTALCODE VARCHAR(255),
    PHONENUMBER VARCHAR(255),
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255),
    RESELLERNAME VARCHAR(255)
);

-- #8 SalesDetail Table
CREATE OR REPLACE TABLE STAGE_SALESDETAILS(
    SALESDETAILID NUMBER(38,0),
    SALESHEADERID NUMBER(38,0),
    PRODUCTID NUMBER(38,0),
    SALESQUANTITY NUMBER(38,0),
    SALESAMOUNT FLOAT,
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255)
);

-- #9 SalesHeader Table
CREATE OR REPLACE TABLE STAGE_SALESHEADER(
    SALESHEADERID NUMBER(38,0),
    DATE VARCHAR(255),
    CHANNELID NUMBER(38,0),
    STOREID NUMBER(38,0),
    CUSTOMERID VARCHAR(255),
    RESELLERID VARCHAR(255),
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255)
);

-- #10 Segment Table
CREATE OR REPLACE TABLE STAGE_SEGMENT(
    SEGMENTID NUMBER(38,0),
    SEGMENT VARCHAR(255),
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255)
);

-- #11 Store Table
CREATE OR REPLACE TABLE STAGE_STORE(
    STOREID NUMBER(38,0),
    SUBSEGMENTID NUMBER(38,0),
    STORENUMBER NUMBER(38,0),
    STOREMANAGER VARCHAR(255),
    ADDRESS VARCHAR(255),
    CITY VARCHAR(255),
    STATEPROVINCE VARCHAR(255),
    COUNTRY VARCHAR(255),
    POSTALCODE VARCHAR(255),
    PHONENUMBER VARCHAR(255),
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255)
);

-- #12 SubSegment Table
CREATE OR REPLACE TABLE STAGE_SUBSEGMENT(
    SUBSEGMENTID NUMBER(38,0),
    SEGMENTID NUMBER(38,0),
    SUBSEGMENT VARCHAR(255),
    CREATEDDATE VARCHAR(255),
    CREATEDBY VARCHAR(255),
    MODIFIEDDATE VARCHAR(255),
    MODIFIEDBY VARCHAR(255)
);

-- #13 Target Data Channel Store Table
CREATE OR REPLACE TABLE STAGE_TARGETCHANNELSTORE(
    YEAR NUMBER(38,0),
    CHANNELNAME VARCHAR(255),
    TARGETNAME VARCHAR(255),
    TARGETSALESAMOUNT NUMBER(38,0)
);

-- #14 Target Data Product Table
CREATE OR REPLACE TABLE STAGE_TARGETPRODUCT(
    PRODUCTID NUMBER(38,0),
    PRODUCT VARCHAR(255),
    YEAR NUMBER(38,0),
    SALESQUANTITYTARGET NUMBER(38,0)
);


//STEP 6 - SELECT Statements
SELECT *
FROM STAGE_TARGETCHANNELSTORE;
